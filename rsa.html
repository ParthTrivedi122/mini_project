<!-- Choose p and q as large, random prime numbers from the user and reject if both are not prime
    Compute n = p * q 
    Compute φ(n) = (p - 1) * (q - 1) 
    Choose e such that 1 < e < φ(n) and e and φ (n) are coprime. Let e = 7 (ask the user for this as well)
    Compute a value for d such that (d * e) % φ(n) = 1. 
    Public key is (e, n) 
    Private key is (d, n) 
    The encryption of message is cipher = (message ^ e) % n
    The decryption of cipher is message = (Cipher ^ d) % n  -->

    <!DOCTYPE html>
    <html lang="en">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA Algorithm Visualizer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        textarea, input {
            width: 100%;
            height: 30px;
            margin-bottom: 10px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
    </head>
    <body>
    
    <input type="number" id="p" placeholder="Enter prime number p">
    <input type="number" id="q" placeholder="Enter prime number q">
    <input type="number" id="e" placeholder="Enter public exponent e">
    <textarea id="input" placeholder="Enter message"></textarea>
    <button onclick="encrypt()">Encrypt</button>
    <button onclick="decrypt()">Decrypt</button>
    <textarea id="output"></textarea>
    
    <script>
    // function isPrime(num) {
    //     if (num <= 1) return false;
    //     if (num <= 3) return true;
    //     if (num % 2 === 0 || num % 3 === 0) return false;
    //     for (let i = 5; i * i <= num; i += 6) {
    //         if (num % i === 0 || num % (i + 2) === 0) return false;
    //     }
    //     return true;
    // }
    // Function to check if a number is prime
function isPrime(num) {
    for(let i = 2, sqrt = Math.sqrt(num); i <= sqrt; i++)
        if(num % i === 0) return false; 
    return num > 1;
}
    
    function generatePrimes() {
        let p, q;
        do {
            p = parseInt(prompt("Enter prime number p"));
        } while (!isPrime(p));
        do {
            q = parseInt(prompt("Enter prime number q"));
        } while (!isPrime(q));
        return { p, q };
    }
    
    function generateKeys() {
        const { p, q } = generatePrimes();
        const n = p * q;
        const phi = (p - 1) * (q - 1);
        let e = parseInt(prompt("Enter public exponent e"));
        while (e <= 1 || e >= phi || !isCoprime(e, phi)) {
            e = parseInt(prompt("Enter a valid public exponent e"));
        }
        const d = modInverse(e, phi);
        return { publicKey: { e, n }, privateKey: { d, n } };
    }
    
    function encrypt() {
        const { publicKey, privateKey } = generateKeys();
        const m = parseInt(document.getElementById('input').value);
        const c = modularExponentiation(m, publicKey.e, publicKey.n);
        document.getElementById('output').value = `Encrypted message: ${c}`;
    }
    
    function decrypt() {
        const { publicKey, privateKey } = generateKeys();
        const c = parseInt(document.getElementById('input').value);
        const m = modularExponentiation(c, privateKey.d, privateKey.n);
        document.getElementById('output').value = `Decrypted message: ${m}`;
    }
    
    function modularExponentiation(base, exponent, modulus) {
        if (modulus === 1) return 0;
        let result = 1;
        base = base % modulus;
        while (exponent > 0) {
            if (exponent % 2 === 1) {
                result = (result * base) % modulus;
            }
            exponent = exponent >> 1;
            base = (base * base) % modulus;
        }
        return result;
    }
    
    // function modInverse(a, m) {
    //     for (let x = 1; x < m; x++) {
    //         if (((a % m) * (x % m)) % m === 1) {
    //             return x;
    //         }
    //     }
    //     return 1;
    // }
    function modInverse(e, phi) {
    e = e % phi;
    for (let x = 1; x < phi; x++)
        if ((e * x) % phi == 1)
            return x;
}
    
    function gcd(a, b) {
        if (b === 0) return a;
        return gcd(b, a % b);
    }
    
    function isCoprime(a, b) {
        return gcd(a, b) === 1;
    }
    </script>
    
    </body>
    </html>
    