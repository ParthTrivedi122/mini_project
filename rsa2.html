<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .highlight {
            background-color: yellow;
        }
    </style>
</head>
<body>
    <input type="number" id="p" placeholder="Enter prime number p">
    <input type="number" id="q" placeholder="Enter prime number q">
    <input type="number" id="message" placeholder="Enter message to be encrypted">
    <input type="number" id="e" placeholder="Enter public key exponent">
    <button onclick="runRSA()">Run RSA</button>
    <div id="output"></div>
    <script>
        // Function to check if a number is prime
        function isPrime(num) {
            for(let i = 2, sqrt = Math.sqrt(num); i <= sqrt; i++)
                if(num % i === 0) return false; 
            return num > 1;
        }

        // Function to calculate gcd
        function gcd(a, b) {
            if (b == 0)
                return a;
            else
                return gcd(b, a % b);
        }

        // Function to find modulo inverse
        function modInverse(e, phi) {
            e = e % phi;
            for (let x = 1; x < phi; x++)
                if ((e * x) % phi == 1)
                    return x;
        }

        // RSA Algorithm
        function RSA(p, q, message, e) {
            if(!isPrime(p) || !isPrime(q)) return "Both numbers must be prime.";
            let n = p * q;
            let phi = (p-1)*(q-1);
            if(gcd(e, phi) != 1) return "e must be coprime with " + phi;

            // Public key: {e, n}
            let publicKey = [e, n];

            // Private key: {d, n}
            let d = modInverse(e, phi);
            let privateKey = [d, n];

            // Encryption
            let cipher = Math.pow(message, e) % n;

            // Decryption
            let decryptedMessage = Math.pow(cipher, d) % n;

            return {
                publicKey: publicKey,
                privateKey: privateKey,
                cipher: cipher,
                decryptedMessage: decryptedMessage
            };
        }

        function runRSA() {
            // Get user input
            let p = document.getElementById('p').value;
            let q = document.getElementById('q').value;
            let message = document.getElementById('message').value;
            let e = document.getElementById('e').value;

            let result = RSA(p, q, message, e);

            // Display the results
            let output = document.getElementById('output');
            output.innerHTML = `
                <div class="highlight">Public Key: ${result.publicKey}</div> -> 
                <div class="highlight">Private Key: ${result.privateKey}</div> -> 
                <div class="highlight">Cipher: ${result.cipher}</div> -> 
                <div class="highlight">Decrypted Message: ${result.decryptedMessage}</div>
            `;
        }
    </script>
</body>
</html>